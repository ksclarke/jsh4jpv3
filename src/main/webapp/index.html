<!DOCTYPE html>

<html data-theme="light">

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.0/css/bulma.min.css">
<title>JPv3 Sandbox</title>
</head>

<body>
  <section class="section">
    <div class="container">
      <h1 class="title">JPv3 Sandbox</h1>
      <pre id="editor" style="height: 20em; margin-top: 40px; margin-bottom: 20px; border: 2px solid #aaa;">
var manifest = new Manifest("https://iiif.io/api/cookbook/recipe/0001-mvm-image/manifest",
  new Label("en", "Single Image Example"));
var canvas = new Canvas(MinterFactory.getMinter(manifest)).setWidthHeight(1200, 1800);
var imageContent = new ImageContent("https://iiif.io/api/presentation/2.1/example/fixtures/resources/page1-full.png");

canvas.paintWith(imageContent.setWidthHeight(1200, 1800));
manifest.setCanvases(canvas);

System.out.println(manifest);
      </pre>
      <script src="https://cdn.jsdelivr.net/npm/ace-builds@1.32.9/src-noconflict/ace.js" type="text/javascript"
        charset="utf-8"></script>
      <script>
      var editor = ace.edit("editor");

      editor.setTheme("ace/theme/tomorrow");
      editor.getSession().setMode("ace/mode/java");
      editor.setFontSize("1em");
      editor.setOption("showLineNumbers", false);

      function clearResults() {
	      var replResults = document.getElementById("replResults");
	      replResults.innerHTML = "";
	    }

      function runCode() {
	      var code = editor.getValue();
	      var xhr = new XMLHttpRequest();

	      xhr.onreadystatechange = function() {
		  	  if (xhr.readyState === XMLHttpRequest.DONE) {
		        var replResults = document.getElementById("replResults");

            if (xhr.status === 200) {
              replResults.innerHTML = xhr.responseText.replace(/</g, "&lt;").replace(/>/g, "&gt;");
            } else {
              replResults.innerHTML = xhr.status;
            }
          }
        };

        xhr.open('POST', '/submit', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.send("code=" + encodeURIComponent(code));
      }
      </script>

      <button onclick="runCode()" class="button is-success">Run Code</button>
      <button onclick="clearResults()" class="button is-warning">Clear Results</button>

      <div style="margin-bottom: 30px; margin-top:30px;"><div style="font-weight: bold; padding-bottom: 20px;">
      Results should appear below (approximately 15 seconds or so after you click the button above)</div>
      If, on submission, you see a <code style="font-weight: bold">jshell&gt;</code> prompt in the box below, JShell
      failed to parse the submitted code. The most likely cause of this is an issue with the submitted code's syntax
      (e.g., a missing parenthesis).</div>

      <pre id="replResults" style="border: 2px solid #aaa"></pre>
    </div>
  </section>
</body>

</html>